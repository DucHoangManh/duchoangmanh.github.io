<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Design pattern thân thiện trong go | duchm</title>
<meta name=keywords content="go,design pattern,efective-go">
<meta name=description content="Tại sao lại có bài viết này?: Design pattern: Những giải pháp có thể tái sử dụng cho các vấn đề thường gặp tại một ngữ cảnh nhất định trong quá trinh thiết kế phần mềm.
Bài viết này nói về một số Design pattern &ldquo;thân thiện&rdquo; hơn trong go, được mình tổng hợp dựa trên buổi talk của Ryan Djurovich (https://www.youtube.com/watch?v=HHqv3_rUr88) và một số nguồn tài liệu khác mà mình đọc được.">
<meta name=author content="Duc">
<link rel=canonical href=https://duchoangmanh.github.io/page/posts/technical/design-pattern-than-thien-trong-go/>
<link crossorigin=anonymous href=/page/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/page/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://duchoangmanh.github.io/page/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://duchoangmanh.github.io/page/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://duchoangmanh.github.io/page/favicon-32x32.png>
<link rel=apple-touch-icon href=https://duchoangmanh.github.io/page/apple-touch-icon.png>
<link rel=mask-icon href=https://duchoangmanh.github.io/page/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.91.2">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript><meta property="og:title" content="Design pattern thân thiện trong go">
<meta property="og:description" content="Tại sao lại có bài viết này?: Design pattern: Những giải pháp có thể tái sử dụng cho các vấn đề thường gặp tại một ngữ cảnh nhất định trong quá trinh thiết kế phần mềm.
Bài viết này nói về một số Design pattern &ldquo;thân thiện&rdquo; hơn trong go, được mình tổng hợp dựa trên buổi talk của Ryan Djurovich (https://www.youtube.com/watch?v=HHqv3_rUr88) và một số nguồn tài liệu khác mà mình đọc được.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://duchoangmanh.github.io/page/posts/technical/design-pattern-than-thien-trong-go/"><meta property="og:image" content="https://duchoangmanh.github.io/page/papermod-cover.png"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-12-26T22:14:29+07:00">
<meta property="article:modified_time" content="2021-12-26T22:14:29+07:00">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://duchoangmanh.github.io/page/papermod-cover.png">
<meta name=twitter:title content="Design pattern thân thiện trong go">
<meta name=twitter:description content="Tại sao lại có bài viết này?: Design pattern: Những giải pháp có thể tái sử dụng cho các vấn đề thường gặp tại một ngữ cảnh nhất định trong quá trinh thiết kế phần mềm.
Bài viết này nói về một số Design pattern &ldquo;thân thiện&rdquo; hơn trong go, được mình tổng hợp dựa trên buổi talk của Ryan Djurovich (https://www.youtube.com/watch?v=HHqv3_rUr88) và một số nguồn tài liệu khác mà mình đọc được.">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://duchoangmanh.github.io/page/posts/"},{"@type":"ListItem","position":2,"name":"Design pattern thân thiện trong go","item":"https://duchoangmanh.github.io/page/posts/technical/design-pattern-than-thien-trong-go/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Design pattern thân thiện trong go","name":"Design pattern thân thiện trong go","description":"Tại sao lại có bài viết này?: Design pattern: Những giải pháp có thể tái sử dụng cho các vấn đề thường gặp tại một ngữ cảnh nhất định trong quá trinh thiết kế phần mềm.\nBài viết này nói về một số Design pattern \u0026ldquo;thân thiện\u0026rdquo; hơn trong go, được mình tổng hợp dựa trên buổi talk của Ryan Djurovich (https://www.youtube.com/watch?v=HHqv3_rUr88) và một số nguồn tài liệu khác mà mình đọc được.","keywords":["go","design pattern","efective-go"],"articleBody":"Tại sao lại có bài viết này?: Design pattern: Những giải pháp có thể tái sử dụng cho các vấn đề thường gặp tại một ngữ cảnh nhất định trong quá trinh thiết kế phần mềm.\nBài viết này nói về một số Design pattern “thân thiện” hơn trong go, được mình tổng hợp dựa trên buổi talk của Ryan Djurovich (https://www.youtube.com/watch?v=HHqv3_rUr88) và một số nguồn tài liệu khác mà mình đọc được.\nFactory pattern Khỏi phải nói về độ phổ biến của nó rồi, rất hữu ích khi cần phải khởi tạo một đối tượng có nhiều triển khai (concrete types), phía client chỉ cần quan tâm đến các method, Factory sẽ lo việc lựa chọn triển khai nào sẽ được dùng để xử lý dữ liệu.\n// use Stringer as the interface  type ErrPrint struct{} func (p *ErrPrint) String() string { return \"some error happens\" } type InfoPrint struct{} func (p *InfoPrint) String() string { return \"nothing dramatically happens\" } func NewPrinter(kind string) (result fmt.Stringer, err error) { switch kind { case \"error\": result = \u0026ErrPrint{} case \"info\": result = \u0026InfoPrint{} default: err = errors.New(\"invalid kind\") } return } Decorator (Functional option) Để nói về pattern này, đầu tiên hãy xem ví dụ bên dưới:\nfunc runServer() { http.HandleFunc(\"/\", helloEndpoint) log.Fatal(http.ListenAndServe(\":8080\", nil)) } func helloEndpoint(w http.ResponseWriter, r *http.Request) { fmt.Fprintf(w, \"Hello world\") } Đoạn code trên tạo ra một web server đơn giản với net/http package với một endpoint duy nhất. Bài toán được đặt ra là bây giờ cần log lại thời gian cần để hoàn tất xử lý request. Để gia tăng tính tái sử dụng, tránh phải sửa lại handler, cũng như dễ dàng bảo trì về sau, ta có thể viết như sau:\nfunc runServer() { http.HandleFunc(\"/\", durationLogger(helloEndpoint)) log.Fatal(http.ListenAndServe(\":8080\", nil)) } func helloEndpoint(w http.ResponseWriter, r *http.Request) { fmt.Fprintf(w, \"Hello world\") } func durationLogger(f http.HandlerFunc) http.HandlerFunc { return func(writer http.ResponseWriter, request *http.Request) { startTime := time.Now() f(writer, request) log.Printf(\"complete handle request after %s ms\", time.Since(startTime).Milliseconds()) } } Như vậy, chúng ta có thể dễ dàng thêm tính năng log thời gian này vào những handler cần thiết, việc thay đổi nội dung log cũng trở nên dễ dàng hơn. Đây chỉ là một ví dụ đơn giản về middleware, trong thực tế việc triển khai có thể phức tạp hơn để phù hợp với các nhù cầu khác nhau.\nIterator Tại sao lại cần pattern này thay vì duyệt (array, slice, map, channel…) trong go?\n Có thể kết hợp với decorator Khi viết một module nào đó mà muốn che giấu triển khai bên dưới, chỉ cho phép phía sử dụng duyệt tuần tự các phần tử. Ví dụ io.Reader, sql/database.Row  type Iterator struct { tasks []string position int } // Next will return the next task in the slice // if there's more data to iterate, more will be true func (t *Iterator) Next() (pos int, val string, more bool) { t.position++ if t.position  len(t.tasks) { return t.position, \"\", false } return t.position, t.tasks[t.position-1], true } Trên đây là một ví dụ đơn giản về triển khai iterator trong go\nfor _, val, more := i.Next(); more; _, val, more = i.Next() { fmt.Println(val) } Dependency Injection DI trong go có thể được triển khai theo nhiều cách, có cả những thư viện chuyên dùng để DI trong go (google/wire, uber-go/fx), trong bài viết này sẽ chỉ nói vể cách triển khai đơn giản nhất\n┌────────────────────┬──────────┬────────────────────────────────┬────────┐ │ Client package │ Client ├─────►  │ │ │ └──────────┘ │ Client Service Interface │ │ │ └─────▲────────────────────┘ │ │ │ │ ├───────────────────────────────────────────┼─────────────────────────────┤ ├───────────────────────────┼───────────────|─────┼─┼──────────────────┼──┤ │ Service package │ Concrete Service 1 │ │Concrete Service 2│ │ │ └─────────────────────┘ └──────────────────┘ │ │ │ │ │ └─────────────────────────────────────────────────────────────────────────┘ Đây là một đoạn code ví dụ co dependency injection sử dụng constructor\nfunc main() { s := NewMyService(os.Stderr) s.WriteHello(\"world\") } type MyService struct { writer io.Writer } func NewMyService(writer io.Writer) MyService { return MyService{ writer: writer, } } func (s *MyService) WriteHello(m string) { fmt.Fprintf(s.writer, \"Hello %s\\n\", m) } Thêm method để có thể sử dụng setter injection:\nfunc (s *MyService) SetWriter(w io.Writer) { s.writer = w } So sánh hai cách:\n constructor: Đảm bảo dependency được sử dụng luôn valid setter: Có thể thay thế concrete service trong quá trình chạy chương trình(runtime)  Repository Một pattern trong thiết kế phần mếm hướng tới việc tiến hóa lâu dài của ứng dụng, các module phụ thuộc có thể được thay đổi trong tương lai. Ví dụ dưới đề thể hiện việc triển khai một ứng dụng mà lớp storage có thể được thay đổi: package post - khai báo model\ntype Post struct { ID int64 Title string } package domain - khai báo các interface client sử dụng để thao tác với storage\n// Repository must be implemented by all implementations of Post storage type Repository interface { FindAll() ([]post.Post, error) Store(post post.Post) (post.Post, error) DeleteById(postId int64) error } package memstorage - một triển khai của storage\n//in-memory implementation type PostStorage struct { posts map[int64]string highestID int64 } func (p *PostStorage) FindAll() ([]post.Post, error) { result := make([]post.Post, 0) for id, title := range p.posts { result = append(result, post.Post{ ID: id, Title: title, }) } return result, nil } func (p *PostStorage) Store(post post.Post) (post.Post, error) { if p.posts == nil { p.posts = make(map[int64]string) } if post.ID  0 { p.highestID++ post.ID = p.highestID } else { if _, exists := p.posts[post.ID]; !exists { return post, fmt.Errorf(\"post already exist\") } } p.posts[post.ID] = post.Title return post, nil } func (p *PostStorage) DeleteById(postId int64) error { delete(p.posts, postId) return nil } Sử dụng repository package: package main\nfunc main() { postRepo := memstorage.PostStorage{} //may change to other implementation in the future \tnewPost, err := postRepo.Store(post.Post{ Title: \"Eagles fly\", }) if err != nil { log.Println(\"can not create post\", err) } else { log.Printf(\"created post with id %d\", newPost.ID) } posts, err := postRepo.FindAll() if err != nil { log.Println(\"can not fetch posts\", err) } else { log.Println(posts) } } Bằng cách chia nhỏ việc triển khai, domain interface và model, trong trường hợp một phần mềm cần thay thế các module trong tương lai, có thể update một cách dễ dàng.\nMã nguồn trong bài viết có thể xem tại: https://github.com/DucHoangManh/go-patterns\n","wordCount":"1043","inLanguage":"en","datePublished":"2021-12-26T22:14:29+07:00","dateModified":"2021-12-26T22:14:29+07:00","author":{"@type":"Person","name":"Duc"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://duchoangmanh.github.io/page/posts/technical/design-pattern-than-thien-trong-go/"},"publisher":{"@type":"Organization","name":"duchm","logo":{"@type":"ImageObject","url":"https://duchoangmanh.github.io/page/favicon.ico"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://duchoangmanh.github.io/page/ accesskey=h title="duchm (Alt + H)">duchm</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=https://duchoangmanh.github.io/page/archives title=Archive>
<span>Archive</span>
</a>
</li>
<li>
<a href=https://duchoangmanh.github.io/page/categories/ title=Categories>
<span>Categories</span>
</a>
</li>
<li>
<a href=https://duchoangmanh.github.io/page/search/ title="Search (Alt + /)" accesskey=/>
<span>Search</span>
</a>
</li>
<li>
<a href=https://duchoangmanh.github.io/page/tags/ title=Tags>
<span>Tags</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=https://duchoangmanh.github.io/page/>Home</a>&nbsp;»&nbsp;<a href=https://duchoangmanh.github.io/page/posts/>Posts</a></div>
<h1 class=post-title>
Design pattern thân thiện trong go
</h1>
<div class=post-meta><span title="2021-12-26 22:14:29 +0700 +0700">December 26, 2021</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Duc&nbsp;|&nbsp;<a href=https://github.com/adityatelange/hugo-PaperMod/tree/exampleSite/content/posts/technical/design-pattern-than-thien-trong-go.md rel="noopener noreferrer" target=_blank>Suggest Changes</a>
</div>
</header> <div class=toc>
<details>
<summary accesskey=c title="(Alt + C)">
<span class=details>Table of Contents</span>
</summary>
<div class=inner><ul><ul>
<li>
<a href=#t%e1%ba%a1i-sao-l%e1%ba%a1i-c%c3%b3-b%c3%a0i-vi%e1%ba%bft-n%c3%a0y aria-label="Tại sao lại có bài viết này?:">Tại sao lại có bài viết này?:</a></li></ul>
<li>
<a href=#factory-pattern aria-label="Factory pattern">Factory pattern</a></li>
<li>
<a href=#decorator-functional-option aria-label="Decorator (Functional option)">Decorator (Functional option)</a></li>
<li>
<a href=#iterator aria-label=Iterator>Iterator</a></li>
<li>
<a href=#dependency-injection aria-label="Dependency Injection">Dependency Injection</a></li>
<li>
<a href=#repository aria-label=Repository>Repository</a>
</li>
</ul>
</div>
</details>
</div>
<div class=post-content><h3 id=tại-sao-lại-có-bài-viết-này>Tại sao lại có bài viết này?:<a hidden class=anchor aria-hidden=true href=#tại-sao-lại-có-bài-viết-này>#</a></h3>
<p>Design pattern: Những giải pháp có thể tái sử dụng cho các vấn đề thường gặp tại một ngữ cảnh nhất định trong quá trinh thiết kế phần mềm.</p>
<p>Bài viết này nói về một số Design pattern &ldquo;thân thiện&rdquo; hơn trong go, được mình tổng hợp dựa trên buổi talk của Ryan Djurovich (<a href="https://www.youtube.com/watch?v=HHqv3_rUr88">https://www.youtube.com/watch?v=HHqv3_rUr88</a>) và một số nguồn tài liệu khác mà mình đọc được.</p>
<h2 id=factory-pattern>Factory pattern<a hidden class=anchor aria-hidden=true href=#factory-pattern>#</a></h2>
<p>Khỏi phải nói về độ phổ biến của nó rồi, rất hữu ích khi cần phải khởi tạo một đối tượng có nhiều triển khai (concrete types), phía client chỉ cần quan tâm đến các method, Factory sẽ lo việc lựa chọn triển khai nào sẽ được dùng để xử lý dữ liệu.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#75715e>// use Stringer as the interface
</span><span style=color:#75715e></span>
<span style=color:#66d9ef>type</span> <span style=color:#a6e22e>ErrPrint</span> <span style=color:#66d9ef>struct</span>{}

<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>p</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>ErrPrint</span>) <span style=color:#a6e22e>String</span>() <span style=color:#66d9ef>string</span> {
	<span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;some error happens&#34;</span>
}

<span style=color:#66d9ef>type</span> <span style=color:#a6e22e>InfoPrint</span> <span style=color:#66d9ef>struct</span>{}

<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>p</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>InfoPrint</span>) <span style=color:#a6e22e>String</span>() <span style=color:#66d9ef>string</span> {
	<span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;nothing dramatically happens&#34;</span>
}

<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>NewPrinter</span>(<span style=color:#a6e22e>kind</span> <span style=color:#66d9ef>string</span>) (<span style=color:#a6e22e>result</span> <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Stringer</span>, <span style=color:#a6e22e>err</span> <span style=color:#66d9ef>error</span>) {
	<span style=color:#66d9ef>switch</span> <span style=color:#a6e22e>kind</span> {
	<span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#34;error&#34;</span>:
		<span style=color:#a6e22e>result</span> = <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>ErrPrint</span>{}
	<span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#34;info&#34;</span>:
		<span style=color:#a6e22e>result</span> = <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>InfoPrint</span>{}
	<span style=color:#66d9ef>default</span>:
		<span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>errors</span>.<span style=color:#a6e22e>New</span>(<span style=color:#e6db74>&#34;invalid kind&#34;</span>)
	}
	<span style=color:#66d9ef>return</span>
}
</code></pre></div><h2 id=decorator-functional-option>Decorator (Functional option)<a hidden class=anchor aria-hidden=true href=#decorator-functional-option>#</a></h2>
<p>Để nói về pattern này, đầu tiên hãy xem ví dụ bên dưới:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>runServer</span>() {
	<span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>HandleFunc</span>(<span style=color:#e6db74>&#34;/&#34;</span>, <span style=color:#a6e22e>helloEndpoint</span>)
	<span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Fatal</span>(<span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>ListenAndServe</span>(<span style=color:#e6db74>&#34;:8080&#34;</span>, <span style=color:#66d9ef>nil</span>))
}
<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>helloEndpoint</span>(<span style=color:#a6e22e>w</span> <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>ResponseWriter</span>, <span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Request</span>) {
	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintf</span>(<span style=color:#a6e22e>w</span>, <span style=color:#e6db74>&#34;Hello world&#34;</span>)
}
</code></pre></div><p>Đoạn code trên tạo ra một web server đơn giản với net/http package với một endpoint duy nhất.
Bài toán được đặt ra là bây giờ cần log lại thời gian cần để hoàn tất xử lý request. Để gia tăng tính tái sử dụng, tránh phải sửa lại handler, cũng như dễ dàng bảo trì về sau, ta có thể viết như sau:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>runServer</span>() {
	<span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>HandleFunc</span>(<span style=color:#e6db74>&#34;/&#34;</span>, <span style=color:#a6e22e>durationLogger</span>(<span style=color:#a6e22e>helloEndpoint</span>))
	<span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Fatal</span>(<span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>ListenAndServe</span>(<span style=color:#e6db74>&#34;:8080&#34;</span>, <span style=color:#66d9ef>nil</span>))
}

<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>helloEndpoint</span>(<span style=color:#a6e22e>w</span> <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>ResponseWriter</span>, <span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Request</span>) {
	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintf</span>(<span style=color:#a6e22e>w</span>, <span style=color:#e6db74>&#34;Hello world&#34;</span>)
}

<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>durationLogger</span>(<span style=color:#a6e22e>f</span> <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>HandlerFunc</span>) <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>HandlerFunc</span> {
	<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>func</span>(<span style=color:#a6e22e>writer</span> <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>ResponseWriter</span>, <span style=color:#a6e22e>request</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Request</span>) {
		<span style=color:#a6e22e>startTime</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Now</span>()
		<span style=color:#a6e22e>f</span>(<span style=color:#a6e22e>writer</span>, <span style=color:#a6e22e>request</span>)
		<span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;complete handle request after %s ms&#34;</span>, <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Since</span>(<span style=color:#a6e22e>startTime</span>).<span style=color:#a6e22e>Milliseconds</span>())
	}
}
</code></pre></div><p>Như vậy, chúng ta có thể dễ dàng thêm tính năng log thời gian này vào những handler cần thiết, việc thay đổi nội dung log cũng trở nên dễ dàng hơn.
Đây chỉ là một ví dụ đơn giản về middleware, trong thực tế việc triển khai có thể phức tạp hơn để phù hợp với các nhù cầu khác nhau.</p>
<h2 id=iterator>Iterator<a hidden class=anchor aria-hidden=true href=#iterator>#</a></h2>
<p>Tại sao lại cần pattern này thay vì duyệt (array, slice, map, channel&mldr;) trong go?</p>
<ul>
<li>Có thể kết hợp với decorator</li>
<li>Khi viết một module nào đó mà muốn che giấu triển khai bên dưới, chỉ cho phép phía sử dụng duyệt tuần tự các phần tử.</li>
<li>Ví dụ io.Reader, sql/database.Row</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Iterator</span> <span style=color:#66d9ef>struct</span> {
	<span style=color:#a6e22e>tasks</span>    []<span style=color:#66d9ef>string</span>
	<span style=color:#a6e22e>position</span> <span style=color:#66d9ef>int</span>
}
<span style=color:#75715e>// Next will return the next task in the slice
</span><span style=color:#75715e>// if there&#39;s more data to iterate, more will be true
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>t</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>Iterator</span>) <span style=color:#a6e22e>Next</span>() (<span style=color:#a6e22e>pos</span> <span style=color:#66d9ef>int</span>, <span style=color:#a6e22e>val</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>more</span> <span style=color:#66d9ef>bool</span>) {
	<span style=color:#a6e22e>t</span>.<span style=color:#a6e22e>position</span><span style=color:#f92672>++</span>
	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>t</span>.<span style=color:#a6e22e>position</span> &gt; len(<span style=color:#a6e22e>t</span>.<span style=color:#a6e22e>tasks</span>) {
		<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>t</span>.<span style=color:#a6e22e>position</span>, <span style=color:#e6db74>&#34;&#34;</span>, <span style=color:#66d9ef>false</span>
	}
	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>t</span>.<span style=color:#a6e22e>position</span>, <span style=color:#a6e22e>t</span>.<span style=color:#a6e22e>tasks</span>[<span style=color:#a6e22e>t</span>.<span style=color:#a6e22e>position</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>], <span style=color:#66d9ef>true</span>
}
</code></pre></div><p>Trên đây là một ví dụ đơn giản về triển khai iterator trong go</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>for</span> <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>val</span>, <span style=color:#a6e22e>more</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>i</span>.<span style=color:#a6e22e>Next</span>(); <span style=color:#a6e22e>more</span>; <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>val</span>, <span style=color:#a6e22e>more</span> = <span style=color:#a6e22e>i</span>.<span style=color:#a6e22e>Next</span>() {
	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>val</span>)
}
</code></pre></div><h2 id=dependency-injection>Dependency Injection<a hidden class=anchor aria-hidden=true href=#dependency-injection>#</a></h2>
<p>DI trong go có thể được triển khai theo nhiều cách, có cả những thư viện chuyên dùng để DI trong go (google/wire, uber-go/fx), trong bài viết này sẽ chỉ nói vể cách triển khai đơn giản nhất</p>
<pre tabindex=0><code>┌────────────────────┬──────────┬────────────────────────────────┬────────┐
│ Client package     │  Client  ├─────►      &lt;&lt;interface&gt;&gt;       │        │
│                    └──────────┘     │ Client Service Interface │        │
│                                     └─────▲────────────────────┘        │
│                                           │                             │
├───────────────────────────────────────────┼─────────────────────────────┤
├───────────────────────────┼───────────────|─────┼─┼──────────────────┼──┤
│ Service package           │  Concrete Service 1 │ │Concrete Service 2│  │
│                           └─────────────────────┘ └──────────────────┘  │
│                                                                         │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
</code></pre><p>Đây là một đoạn code ví dụ co dependency injection sử dụng constructor</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
    <span style=color:#a6e22e>s</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>NewMyService</span>(<span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Stderr</span>)
    <span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>WriteHello</span>(<span style=color:#e6db74>&#34;world&#34;</span>)
}
<span style=color:#66d9ef>type</span> <span style=color:#a6e22e>MyService</span> <span style=color:#66d9ef>struct</span> {
    <span style=color:#a6e22e>writer</span> <span style=color:#a6e22e>io</span>.<span style=color:#a6e22e>Writer</span>
}
<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>NewMyService</span>(<span style=color:#a6e22e>writer</span> <span style=color:#a6e22e>io</span>.<span style=color:#a6e22e>Writer</span>) <span style=color:#a6e22e>MyService</span> {
    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>MyService</span>{
        <span style=color:#a6e22e>writer</span>: <span style=color:#a6e22e>writer</span>,
    }
}
<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>s</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>MyService</span>) <span style=color:#a6e22e>WriteHello</span>(<span style=color:#a6e22e>m</span> <span style=color:#66d9ef>string</span>) {
    <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintf</span>(<span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>writer</span>, <span style=color:#e6db74>&#34;Hello %s\n&#34;</span>, <span style=color:#a6e22e>m</span>)
}
</code></pre></div><p>Thêm method để có thể sử dụng setter injection:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>s</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>MyService</span>) <span style=color:#a6e22e>SetWriter</span>(<span style=color:#a6e22e>w</span> <span style=color:#a6e22e>io</span>.<span style=color:#a6e22e>Writer</span>) {
    <span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>writer</span> = <span style=color:#a6e22e>w</span>
}
</code></pre></div><p>So sánh hai cách:</p>
<ul>
<li>constructor: Đảm bảo dependency được sử dụng luôn valid</li>
<li>setter: Có thể thay thế concrete service trong quá trình chạy chương trình(runtime)</li>
</ul>
<h2 id=repository>Repository<a hidden class=anchor aria-hidden=true href=#repository>#</a></h2>
<p>Một pattern trong thiết kế phần mếm hướng tới việc tiến hóa lâu dài của ứng dụng, các module phụ thuộc có thể được thay đổi trong tương lai.
Ví dụ dưới đề thể hiện việc triển khai một ứng dụng mà lớp storage có thể được thay đổi:
<code>package post</code> - khai báo model</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Post</span> <span style=color:#66d9ef>struct</span> {
	<span style=color:#a6e22e>ID</span>   <span style=color:#66d9ef>int64</span>
	<span style=color:#a6e22e>Title</span> <span style=color:#66d9ef>string</span>
}
</code></pre></div><p><code>package domain</code> - khai báo các interface client sử dụng để thao tác với storage</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#75715e>// Repository must be implemented by all implementations of Post storage
</span><span style=color:#75715e></span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Repository</span> <span style=color:#66d9ef>interface</span> {
	<span style=color:#a6e22e>FindAll</span>() ([]<span style=color:#a6e22e>post</span>.<span style=color:#a6e22e>Post</span>, <span style=color:#66d9ef>error</span>)
	<span style=color:#a6e22e>Store</span>(<span style=color:#a6e22e>post</span> <span style=color:#a6e22e>post</span>.<span style=color:#a6e22e>Post</span>) (<span style=color:#a6e22e>post</span>.<span style=color:#a6e22e>Post</span>, <span style=color:#66d9ef>error</span>)
	<span style=color:#a6e22e>DeleteById</span>(<span style=color:#a6e22e>postId</span> <span style=color:#66d9ef>int64</span>) <span style=color:#66d9ef>error</span>
}
</code></pre></div><p><code>package memstorage</code> - một triển khai của storage</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#75715e>//in-memory implementation
</span><span style=color:#75715e></span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>PostStorage</span> <span style=color:#66d9ef>struct</span> {
	<span style=color:#a6e22e>posts</span>     <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>int64</span>]<span style=color:#66d9ef>string</span>
	<span style=color:#a6e22e>highestID</span> <span style=color:#66d9ef>int64</span>
}

<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>p</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>PostStorage</span>) <span style=color:#a6e22e>FindAll</span>() ([]<span style=color:#a6e22e>post</span>.<span style=color:#a6e22e>Post</span>, <span style=color:#66d9ef>error</span>) {
	<span style=color:#a6e22e>result</span> <span style=color:#f92672>:=</span> make([]<span style=color:#a6e22e>post</span>.<span style=color:#a6e22e>Post</span>, <span style=color:#ae81ff>0</span>)
	<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>id</span>, <span style=color:#a6e22e>title</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>posts</span> {
		<span style=color:#a6e22e>result</span> = append(<span style=color:#a6e22e>result</span>, <span style=color:#a6e22e>post</span>.<span style=color:#a6e22e>Post</span>{
			<span style=color:#a6e22e>ID</span>:    <span style=color:#a6e22e>id</span>,
			<span style=color:#a6e22e>Title</span>: <span style=color:#a6e22e>title</span>,
		})
	}
	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>result</span>, <span style=color:#66d9ef>nil</span>
}

<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>p</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>PostStorage</span>) <span style=color:#a6e22e>Store</span>(<span style=color:#a6e22e>post</span> <span style=color:#a6e22e>post</span>.<span style=color:#a6e22e>Post</span>) (<span style=color:#a6e22e>post</span>.<span style=color:#a6e22e>Post</span>, <span style=color:#66d9ef>error</span>) {
	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>posts</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>nil</span> {
		<span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>posts</span> = make(<span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>int64</span>]<span style=color:#66d9ef>string</span>)
	}
	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>post</span>.<span style=color:#a6e22e>ID</span> <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0</span> {
		<span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>highestID</span><span style=color:#f92672>++</span>
		<span style=color:#a6e22e>post</span>.<span style=color:#a6e22e>ID</span> = <span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>highestID</span>
	} <span style=color:#66d9ef>else</span> {
		<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>exists</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>posts</span>[<span style=color:#a6e22e>post</span>.<span style=color:#a6e22e>ID</span>]; !<span style=color:#a6e22e>exists</span> {
			<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>post</span>, <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Errorf</span>(<span style=color:#e6db74>&#34;post already exist&#34;</span>)
		}
	}
	<span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>posts</span>[<span style=color:#a6e22e>post</span>.<span style=color:#a6e22e>ID</span>] = <span style=color:#a6e22e>post</span>.<span style=color:#a6e22e>Title</span>
	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>post</span>, <span style=color:#66d9ef>nil</span>

}

<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>p</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>PostStorage</span>) <span style=color:#a6e22e>DeleteById</span>(<span style=color:#a6e22e>postId</span> <span style=color:#66d9ef>int64</span>) <span style=color:#66d9ef>error</span> {
	delete(<span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>posts</span>, <span style=color:#a6e22e>postId</span>)
	<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>
}
</code></pre></div><p>Sử dụng repository package:
<code>package main</code></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
	<span style=color:#a6e22e>postRepo</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>memstorage</span>.<span style=color:#a6e22e>PostStorage</span>{}
	<span style=color:#75715e>//may change to other implementation in the future
</span><span style=color:#75715e></span>	<span style=color:#a6e22e>newPost</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>postRepo</span>.<span style=color:#a6e22e>Store</span>(<span style=color:#a6e22e>post</span>.<span style=color:#a6e22e>Post</span>{
		<span style=color:#a6e22e>Title</span>: <span style=color:#e6db74>&#34;Eagles fly&#34;</span>,
	})
	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
		<span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;can not create post&#34;</span>, <span style=color:#a6e22e>err</span>)
	} <span style=color:#66d9ef>else</span> {
		<span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;created post with id %d&#34;</span>, <span style=color:#a6e22e>newPost</span>.<span style=color:#a6e22e>ID</span>)
	}
	<span style=color:#a6e22e>posts</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>postRepo</span>.<span style=color:#a6e22e>FindAll</span>()
	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
		<span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;can not fetch posts&#34;</span>, <span style=color:#a6e22e>err</span>)
	} <span style=color:#66d9ef>else</span> {
		<span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>posts</span>)
	}
}
</code></pre></div><p>Bằng cách chia nhỏ việc triển khai, domain interface và model, trong trường hợp một phần mềm cần thay thế các module trong tương lai, có thể update một cách dễ dàng.</p>
<p>Mã nguồn trong bài viết có thể xem tại: <a href=https://github.com/DucHoangManh/go-patterns>https://github.com/DucHoangManh/go-patterns</a></p>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://duchoangmanh.github.io/page/tags/go/>go</a></li>
<li><a href=https://duchoangmanh.github.io/page/tags/design-pattern/>design pattern</a></li>
<li><a href=https://duchoangmanh.github.io/page/tags/efective-go/>efective-go</a></li>
</ul>
<nav class=paginav>
<a class=prev href=https://duchoangmanh.github.io/page/posts/technical/create-a-web-framework-in-go/>
<span class=title>« Prev Page</span>
<br>
<span>Create a web framework in Go part 1: static routing prototype</span>
</a>
</nav>
<div class=share-buttons>
<a target=_blank rel="noopener noreferrer" aria-label="share Design pattern thân thiện trong go on twitter" href="https://twitter.com/intent/tweet/?text=Design%20pattern%20th%c3%a2n%20thi%e1%bb%87n%20trong%20go&url=https%3a%2f%2fduchoangmanh.github.io%2fpage%2fposts%2ftechnical%2fdesign-pattern-than-thien-trong-go%2f&hashtags=go%2cdesignpattern%2cefective-go"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Design pattern thân thiện trong go on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fduchoangmanh.github.io%2fpage%2fposts%2ftechnical%2fdesign-pattern-than-thien-trong-go%2f&title=Design%20pattern%20th%c3%a2n%20thi%e1%bb%87n%20trong%20go&summary=Design%20pattern%20th%c3%a2n%20thi%e1%bb%87n%20trong%20go&source=https%3a%2f%2fduchoangmanh.github.io%2fpage%2fposts%2ftechnical%2fdesign-pattern-than-thien-trong-go%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Design pattern thân thiện trong go on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fduchoangmanh.github.io%2fpage%2fposts%2ftechnical%2fdesign-pattern-than-thien-trong-go%2f&title=Design%20pattern%20th%c3%a2n%20thi%e1%bb%87n%20trong%20go"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Design pattern thân thiện trong go on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fduchoangmanh.github.io%2fpage%2fposts%2ftechnical%2fdesign-pattern-than-thien-trong-go%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Design pattern thân thiện trong go on whatsapp" href="https://api.whatsapp.com/send?text=Design%20pattern%20th%c3%a2n%20thi%e1%bb%87n%20trong%20go%20-%20https%3a%2f%2fduchoangmanh.github.io%2fpage%2fposts%2ftechnical%2fdesign-pattern-than-thien-trong-go%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Design pattern thân thiện trong go on telegram" href="https://telegram.me/share/url?text=Design%20pattern%20th%c3%a2n%20thi%e1%bb%87n%20trong%20go&url=https%3a%2f%2fduchoangmanh.github.io%2fpage%2fposts%2ftechnical%2fdesign-pattern-than-thien-trong-go%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg>
</a>
</div>
</footer>
</article>
</main>
<footer class=footer>
<span>&copy; 2022 <a href=https://duchoangmanh.github.io/page/>duchm</a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
<script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script>
</body>
</html>